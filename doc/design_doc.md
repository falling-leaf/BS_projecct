## 商品价格比较网站-设计报告

### 一、项目背景

    本项目是2024-2025秋冬学期《B/S体系软件设计》的课程项目，旨在设计一个商品价格比较网站，要求实现用户注册、登录功能，注册时需要填写必要信息以验证；用户登陆后通过商品名称在主流电商平台（至少2个以上）上查询该商品实时价格；建立商品库并保存；提供商品查询界面并分析商品历史价格；支持降价提醒（邮件或APP推送方式）；并且要求样式适配手机，开发对应手机APP或能够在内置浏览器中友好显示。同时也需要提供必要的软件项目文档，使自己了解并掌握一套web应用开发技术和开发的总体流程。

    本文档是该项目的系统设计文档，包含了系统的需求分析，系统的总体架构设计，以及数据库的设计和系统接口、界面原型的设计等内容，详细介绍了物联网设备应用网站的设计情况。

    该项目需要包含完整的web前后端，对应部署服务器，以及相关项目文档等内容，并且由一人独立完成。

### 二、系统需求分析

#### 2.1 功能性需求分析

    该项目主要是一个B/S架构的web应用，对于每个用户需要实现如下功能性需求：

- 用户注册（需要用户名、密码、手机号、邮箱等关键信息）
- 用户登录
- 用户信息修改
- 用户通过商品名称查询商品实时价格
- 用户通过商品名称查询商品历史价格分析
- 用户通过设置降价提醒能够获取定时的降价发送提醒

  该系统的主要用户为普通用户与管理员，普通用户可以通过用户接口对该系统的一系列功能进行使用；管理员需要定期维护系统的所有信息（包括商品的历史信息与实时信息）。

  因此，该项目的功能性需求主要可分为两个模块，一个是用户信息模块，另一个是商品管理模块。这些功能性需求的关系和模块划分图可表示为：

![1726889836458](image/design_doc/1726889836458.png)

![1726889846130](image/design_doc/1726889846130.png)

其中每个功能还有若干子功能，例如用户注册包括邮箱绑定、账号密码保密性限制；用户信息修改包括通过邮箱找回密码、更改账号名等功能；历史价格查询包括对不同时间点的价格图表与分析结果等等。

#### 2.2 非功能性需求分析

该系统的 非功能性需求包括性能需求，输入输出需求，数据管理需求等，具体的要求如下：

##### 2.2.1 性能需求

- 系统应保证运行稳定，避免出现崩溃；
- 当前主流浏览器均能正常访问本系统；
- 系统应能保证至少100人的并发访问；
- 当用户登录以及进行任何操作时，系统应该能及时进行反应，反应的时间在1s以内；
- 系统应该能及时检测出各种非正常情况，如与设备的通信中断断开，无法连接数据库服务系统应该能及时检测出各种非正常情况，避免用户长时间等待；
- 每个页面一般情况下应在1s内加载完毕，高峰期应在5s内加载完毕；
- 系统保证在一周内不超过一次维护与重启。

##### 2.2.2 输入输出需求

- 在用户输入账号密码时，应对数据输入进行数据有效性检查，同时应该确保其安全性；
- 商品的历史价格走向等信息必须以可视化的图标等方式呈现，需要美观而准确显示数据库中的数据；
- 此外，系统应通过程序控制出错几率，减少系统因用户人为的错误引起的破坏，开发者应当尽量周全地考虑到各种可能发生的问题，使出错的可能降至最小。

##### 2.2.3 数据管理需求

- 系统既要与其他系统有接口，又必须保证本系统的独立性与完整性。即应防止未经授权的各类人员对本系统进行设置和修改或访问系统内部数据。
- 系统服务器软件必须提供可靠的数据备份和恢复手段，在服务器软件或硬件出现严重故障时，能够根据备份的数据和账户信息迅速恢复正常运行环境。同时，软件开发者不得在系统中预留任何特殊账户和密码，保证其安全性。
- 除此之外，系统应具备加密登录、数据加密传输等安全方面的保障，保证数据在不用系统间传输过程中的保密性与安全性。

##### 2.3 条件与限制

- 服务器运行环境限制：
  - 操作系统：Windows10或以上版本，或Linux系统；
  - 硬件配置：具备4核CPU、8GB内存及以上；
  - 软件环境：
    - Web服务器：使用Nginx 1.10或以上版本作为Web服务器；
    - 前端框架：使用React 18.3或以上的版本，以及对应版本的React-dom、React-router-dom等库；
    - 后端框架：使用Spring Boot 2.6或以上版本，以及对应版本的Spring Data JPA等库；
    - 数据库：使用MySQL 8.0或以上版本，并配置好相应的数据库连接；
  - 网络环境：使用HTTP协议对系统进行传输
- 开发过程代码规范限制：
  - 代码风格：遵循Google Java编程规范，使用Intellij IDEA或VScode等IDE进行开发；
  - 避免使用过时、不安全的技术：尽量使用最新的技术，避免使用过时的技术，如使用过时的Spring版本等；
  - 代码注释：代码中需要添加详细的注释，方便其他开发者阅读和理解；
  - 严格控制代码质量，避免出现内存泄漏、缓冲区溢出、SQL注入等安全漏洞；
  - 采用版本控制工具：如Git等，方便团队协作开发。

### 三、系统技术选型

#### 3.1 项目技术选型

本项目采用前后端分离的开发模式，前端采用HTML、CSS、JavaScript等技术，后端采用Java、Spring、MySQL等技术。前端负责页面的呈现，后端负责数据的处理与存储。

#### 3.2 项目主要技术介绍

##### 3.2.1 前端技术框架

本项目前端采用React+Antd+npm包管理工具作为主体框架：

1. React: React 是由 Facebook 开发并开源的一个用于构建用户界面的 JavaScript 库，特别适用于构建单页应用（SPA）。它主要负责视图层的渲染，提供了一种高效更新用户界面的方式。它具备组件化、声明式、虚拟DOM、单向数据流、JSX语法等特性，可以帮助开发者快速开发出高质量的产品。
2. Antd: Ant Design（简称 Antd）是由阿里巴巴推出的企业级 UI 设计语言和 React 组件库，主要用于构建复杂的、数据密集型的企业级应用。它提供了一套完整的设计规范和丰富的 UI 组件，帮助开发者快速创建高质量的 Web 应用。Antd具备丰富的组件库、一致的设计语言、响应式设计、国际化支持、按需加载等特点，特别适合企业级应用和管理系统的开发。
3. npm包管理工具: npm（Node Package Manager）是Node.js的默认包管理工具，用于管理JavaScript代码库和项目依赖。它为开发者提供了以下功能：

- 包管理：npm允许开发者轻松地安装、更新和删除项目的依赖包。它支持一个庞大的开源包库，开发者可以通过npm下载和使用现成的工具和库。
- 依赖管理：npm通过 `package.json`文件记录项目的依赖，确保所有开发者和部署环境都能使用相同的版本。开发者可以使用 `npm install`来自动安装这些依赖。

##### 3.2.2 后端技术框架

本项目后端采用Spring boot +  Spring Data JPA作为主体框架，同时采用MySQL作为数据库：

1. Spring boot：Spring Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的XML文件。Spring Boot 以其简化配置、快速开发、灵活扩展的特性，成为 Java 后端开发的主流选择之一，广泛应用于微服务、企业级应用和 Web 开发。
2. Spring Data JPA：Spring Data JPA 是 Spring Data 项目下的一个子模块，专门用于简化与 JPA（Java Persistence API） 数据访问层的集成。它为基于 JPA 的持久化提供了高级抽象，减少了重复代码，并使开发者能够更加便捷地进行数据库操作。Spring Data JPA 极大地减少了与数据库交互时的模板代码，使开发者专注于业务逻辑的实现，提高了开发效率。它特别适合快速开发数据驱动的应用。
3. MySQL：MySQL 是一个开源的关系型数据库管理系统（RDBMS），广泛用于Web应用、数据分析等领域。它以其高性能、可靠性和易用性成为全球最流行的数据库之一。MySQL 以其高效、可靠和易用的特性，成为小型到中大型应用的数据库首选，特别适合 Web 开发和数据驱动的应用程序。

### 四、系统架构设计

#### 4.1 系统总体架构图

本系统采用经典的B/S架构，前端负责页面的呈现，后端负责数据的处理与存储。系统的总体架构图如下：

![1728198518840](image/design_doc/1728198518840.png)

#### 4.2 前端架构图

本系统前端采用React+Antd+npm包管理工具作为主体框架，前端架构图如下：

![1728198776815](image/design_doc/1728198776815.png)

#### 4.3 后端架构图

本系统后端采用Spring框架的经典三层架构（Controller、Service、Dao），Dao层负责与数据库的交互，Service层负责业务逻辑的处理，Controller层负责处理请求并返回响应。后端架构图如下：

![1728200550377](image/design_doc/1728200550377.png)

### 四、数据库设计与E-R图

#### 4.1 数据表设计

    本项目的数据库共设计两个数据表，分别用于存储用户信息与商品信息，具体的表结构设计情况如下：

##### 4.1.1 user表

- 该表用于保存用户的信息：

|  字段名  |     类型     |   描述   |       备注       |
| :------: | :----------: | :------: | :--------------: |
|    id    |     int     | 用户的id | 主键，非空，自增 |
| account | varchar(128) |  用户名  |   非空，unique   |
| password | varchar(128) | 用户密码 |       非空       |
|  email  | varchar(128) |   邮箱   |   非空，unique   |

##### 4.1.2 item表

- 该表用于保存商品的信息：

|   字段名   |     类型     |       描述       |       备注       |
| :---------: | :-----------: | :--------------: | :--------------: |
|     id     |      int      |     商品的id     | 主键，非空，自增 |
|    name    | varchar(128) |     商品名称     |       非空       |
|    price    | decimal(10,2) |     商品价格     |       非空       |
| update_time |   datetime   |   商品更新时间   |       非空       |
|  resource  | varchar(128) |   商品来源平台   |       非空       |
|    size    | varchar(128) |     商品规格     |                  |
| description | varchar(512) |     商品描述     |                  |
|    image    | varchar(256) |   商品图片地址   |                  |
|  linecode  | varchar(256) |    商品条形码    |                  |
|  category  | varchar(1024) | 商品多级品类路径 |                  |

##### 4.1.3 history表

- 该表用于保存用户对商品的搜索历史：

|   字段名   |   类型   |     描述     |       备注       |
| :---------: | :------: | :----------: | :--------------: |
|     id     |   int   | 搜索历史的id | 主键，非空，自增 |
|   user_id   |   int   |   用户的id   |       非空       |
|   item_id   |   int   |   商品的id   |       非空       |
| search_time | datetime |   搜索时间   |       非空       |

### 五、系统接口设计

#### 5.1 用户信息相关接口

##### 5.1.1 用户登录

|   项目   |          内容          |
| :------: | :--------------------: |
|   URL   |      /user/login      |
| 请求方式 |          POST          |
| 请求参数 |   account、password   |
| 返回参数 | token(若成功)、message |

简介：用户登录接口，用于验证用户的账号密码。根据不同情况有以下处理结果：

|     情况     |                  返回值                  |
| :----------: | :--------------------------------------: |
|  账号不存在  |        message: “用户不存在”；        |
|   密码错误   |         message: “密码错误”；         |
| 账号密码正确 | token，message: “login successfully”。 |

##### 5.1.2 用户注册

|   项目   |           内容           |
| :------: | :----------------------: |
|   URL   |      /user/register      |
| 请求方式 |           POST           |
| 请求参数 | account、password、email |
| 返回参数 |         message         |

简介：用户注册接口，用于用户注册。根据不同情况有以下处理结果：

|        情况        |                返回值                |
| :----------------: | :----------------------------------: |
|     账号已存在     |      message: “账号已存在”；      |
|     邮箱已存在     |      message: “邮箱已存在”；      |
| 账号格式不符合要求 |      message: “帐户名过短”；      |
| 密码格式不符合要求 |       message: “密码过短”；       |
| 邮箱格式不符合要求 |     message: “邮箱格式有误”；     |
|  并非以上所有情况  | message: “register successfully”； |

##### 5.1.3 发送验证码

|   项目   |       内容       |
| :------: | :--------------: |
|   URL   | /user/send_email |
| 请求方式 |       GET       |
| 请求参数 |      email      |
| 返回参数 |     message     |

简介：发送验证码接口，用于用户注册时发送验证码到邮箱。根据不同情况有以下处理结果：

|      情况      |            返回值            |
| :------------: | :---------------------------: |
|   邮箱不存在   |   message: “邮箱不存在”；   |
| 验证码发送成功 | message: “验证码发送成功”； |

##### 5.1.4 重置密码

|   项目   |              内容              |
| :------: | :-----------------------------: |
|   URL   |      /user/reset_password      |
| 请求方式 |              POST              |
| 请求参数 | account、password、 email、code |
| 返回参数 |             message             |

简介：重置密码接口，用于用户忘记密码时重置密码。根据不同情况有以下处理结果：

|        情况        |              返回值              |
| :----------------: | :-------------------------------: |
|     账号不存在     |     message: “用户不存在”；     |
| 邮箱与帐户名不匹配 | message: “邮箱与帐户名不匹配”； |
|     验证码错误     |     message: “验证码错误”；     |
| 密码格式不符合要求 |      message: “密码过短”；      |
|    密码重置成功    | message: “reset successfully”； |

#### 5.2 商品信息相关接口

##### 5.2.1 商品实时查询

|   项目   |           内容           |
| :------: | :----------------------: |
|   URL   |       /item/price       |
| 请求方式 |           GET           |
| 请求参数 |           name           |
| 返回参数 | items(商品列表)，message |

简介：商品实时价格查询接口，用于查询商品的实时价格。根据不同情况有以下处理结果：

|     情况     |                返回值                |
| :----------: | :-----------------------------------: |
|  商品不存在  | items: []； message: “商品不存在”； |
|   请求超时   |  items: []； message: “请求超时”；  |
| 正常查询成功 |    items； message: “查询成功”；    |

##### 5.2.2 商品价格趋势查询

|   项目   |      内容      |
| :------: | :------------: |
|   URL   |  /item/trend  |
| 请求方式 |      GET      |
| 请求参数 |      name      |
| 返回参数 | price，message |

简介：商品价格趋势查询接口，用于查询商品的价格趋势。根据不同情况有以下处理结果：

|     情况     |                 返回值                 |
| :----------: | :-------------------------------------: |
|  商品不存在  | price: null； message: “商品不存在”； |
|   请求超时   |  price: null； message: “请求超时”；  |
| 正常查询成功 |     price； message: “查询成功”；     |

##### 5.2.3 用户搜索历史查询

|   项目   |               内容               |
| :------: | :------------------------------: |
|   URL   |          /history/query          |
| 请求方式 |               GET               |
| 请求参数 |             user_id             |
| 返回参数 | histories(搜索历史列表)，message |

简介：用户搜索历史查询接口，用于查询用户的搜索历史。根据不同情况有以下处理结果：

|     情况     |                  返回值                  |
| :----------: | :---------------------------------------: |
|  用户不存在  | histories: []； message: “用户不存在”； |
|   请求超时   |  histories: []； message: “请求超时”；  |
| 正常查询成功 |    histories； message: “查询成功”；    |

### 六、系统界面原型

#### 6.1 登录界面

#### 6.2 注册界面

#### 6.3 网站首页

#### 6.4 个人信息

### 七、附录

#### 7.1 项目进度安排

|     时间段     |            计划进度            |
| :------------: | :----------------------------: |
|    2024.10    |  完成设计报告以及初步框架搭建  |
| 2024.11 上中旬 |       系统前后端代码开发       |
|  2024.11 下旬  | 系统集成与测试以及相关文档编写 |
|    2024.12    |       用户手册等文档编写       |

#### 7.2 备注

本设计文档内容仅供参考，最终效果以实现代码为准。
